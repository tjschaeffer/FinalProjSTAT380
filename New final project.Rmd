---
title: "STAT 380 Final Project"
author: "Greg Westfall and TJ Schaeffer"
output: html_notebook
---

```{r}
# Libraries
library(mdsr)
library(readr)
library(dplyr)
library(tidyr)

```


```{r}
# Reading in Terrorism 
terrorism <- read.table(unz("globalterrorismdb_0718dist.csv.zip", "globalterrorismdb_0718dist.csv"), nrows=181692, header=T, fill =T, quote="\"", sep=",")

econData <- read.csv("WEO_Data.csv")

```

```{r}
econData <- read.csv("WEO_Data.csv")

```

```{r}
terrorism_deaths <-
  terrorism %>%
  group_by(country_txt) %>%
  summarise(attacks = n(), deaths = sum(na.omit(nkill))) %>%
  arrange(desc(deaths))

terrorism_deaths

```

```{r}
terrorism %>%
  sample(5000) %>%
  ggplot(aes(x = longitude, y = latitude)) +
  geom_point()
```

```{r}
terrorism %>%
  filter(country_txt == "United States") %>%
  filter(longitude < 0) %>%
  filter(nkillus > 0) %>%
  ggplot(aes(x = longitude, y = latitude)) +
  geom_point(aes(color = nkillus))
```

```{r}
# terrorism %>%
#   inner_join(econData)

```


```{r}
head(econData)

```

```{r}
econNumeric <- apply(X = econData[,5:30], FUN = as.numeric, MARGIN = 2)

econDataNew <-
  econData %>%
  select(c(1:4))
  
econData2 <-
  as.data.frame(econNumeric)

econDataNew <-
  econDataNew %>%
  cbind(econData2)

econDataNew
  
```

```{r}
econDataTidy <-
  econDataNew %>%
  gather(key = "Year", value = "Value", 5:30)

econDataTidy

```

```{r}
econAverages <-
  econDataTidy %>%
  group_by(Country, Subject.Descriptor, Units) %>%
  summarise(average = mean(na.omit(Value)))

econAverages

```

```{r}
create_deaths_table <- function(x, y){
  econAverages %>%
    filter(Subject.Descriptor == x, Units == y) %>%
    rename("country_txt" = "Country") %>%
    left_join(terrorism_deaths, by = "country_txt") %>%
    rename("Country" = "country_txt")
}

```

```{r}
PopDeaths <- create_deaths_table("Population", "Persons")
PopDeaths

```

```{r}
GDPDeaths <- create_deaths_table("Gross domestic product per capita, constant prices",
                                 "Purchasing power parity; 2011 international dollar")
GDPDeaths

```

```{r}
InflationDeaths <- create_deaths_table("Inflation, average consumer prices",
                                       "Index")
InflationDeaths

```

```{r}
SpendingDeaths <- create_deaths_table("General government total expenditure",
                                      "Percent of GDP")
SpendingDeaths

```

```{r}
ImportDeaths <- create_deaths_table("Volume of imports of goods and services",
                                    "Percent change")
ImportDeaths

```

